# PoC for Google Nexus 9 SensorHub Firmware Downgrade Vulnerability (CVE-2017-0582) #

A modified `CwMcuSensor` driver that allows one to reboot the `STM32F401B/C` ARM Cortext-M4 MCU into its bootloader mode and issue commands via I2C.
By creating this PoC we successfully obtained the old firmware from the SoC itself (it can also be fetched from the flash):

1. We downgraded the SoC firmware by exploiting `CVE-2017-0582`.
2. The modified `CwMcuSensor` driver has a disabled firmware version check, and adds a `sysfs` interface which allows one  to reboot the MCU into its bootloader mode and issue various bootloader commands such as `READMEMORY` [command](http://www.st.com/content/ccc/resource/technical/document/application_note/35/7d/5b/bf/67/75/41/d6/CD00251611.pdf/files/CD00251611.pdf/jcr:content/translations/en.CD00251611.pdf). 
3. The firmware can be fetched  from address `0x08000000`

One can now take the old firmware and search for vulnerabilities.

More info can be found on our [vulnerability report](https://alephsecurity.com/vulns/aleph-2017010)
